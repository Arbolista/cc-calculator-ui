<div rt-if="this.props.show" rt-class="{item: !this.props.is_assumption, active: this.props.active && !this.props.is_assumption}" id={this.props.action_key}>
  <div className="action" rt-if="!this.props.is_assumption">
    <div className="action__heading">
      <div className="action__status">
        <div class="btn-group" role="group">
          <button rt-if="!this.pledged" className="btn btn-default"
            onClick="{this.toggleActionDone.bind(this)}" rt-class="{'action__status--done': this.already_done}">
              {this.t('action.already_done')}
          </button>
          <button className="btn btn-default"
            rt-if="!this.already_done"
            onClick="{this.toggleActionPledge.bind(this)}" rt-class="{'action__status--taken': this.pledged}"> <span rt-if="!this.pledged">{this.t('action.pledge')} </span>
            <span rt-if="this.pledged">{this.t('action.pledged')} </span>
            <i className="fa" rt-class="{'fa-check-square-o': !this.pledged, 'fa-check-square': this.pledged && !this.props.is_authenticated}"></i>
          </button>
          <button rt-if="this.taken && this.props.is_authenticated"
            className="btn btn-default"
            onClick="{this.toggleActionComplete.bind(this)}" rt-class="{'action__status--completed': this.completed}"> <span rt-if="!this.completed">{this.t('action.complete')} </span>
            <span rt-if="this.completed">{this.t('action.completed')} </span>
            <i className="fa" rt-class="{'fa-check-square-o': !this.completed, 'fa-check-square': this.completed}"></i>
          </button>
        </div>
      </div>
    </div>
    <div className="action__block">
      <div className="action__title">
        <h3>{this.display_name}</h3>
      </div>
      <div className="action__savings">
        <div>
          <div className="action__savings-amount">{this.tons_saved_formatted}</div>
          <div className="action__savings-label">{this.t('take_action.tons_saved')}</div>
        </div>
        <div>
          <div className="action__savings-amount">${this.dollars_saved_formatted}</div>
          <div className="action__savings-label">{this.t('take_action.dollars_saved')}</div>
        </div>
        <div>
          <div className="action__savings-amount">${this.upfront_cost_formatted}</div>
          <div className="action__savings-label">{this.t('take_action.upfront_cost')}</div>
        </div>
      </div>
      <div className="action__more-details" rt-class="{toggled: this.state.detailed}">
        <button className="btn btn-default" onClick="{this.toggleActionDetails.bind(this)}">{this.t('action.more_details')} <span class="caret"></span></button>
      </div>
    </div>
    <div className="action__details" rt-class="{hidden: !this.state.detailed}" rt-if="this.vehicles_loaded">
      <hr>
      <div className="action__content">
         <table className="table">
           <tbody>
             <rt-virtual rt-repeat="block in this.content" key="{blockIndex}">
               <tr rt-if="!block.assumptions">
                 <td colspan="2" rt-if="block.text_only">
                   <p>
                     <span rt-if="!block.text_url">{block.description}</span>
                     <a rt-if="block.text_url" href="{block.text_url}">{block.description}</a>
                   </p>
                 </td>
                 <td colspan="0" rt-if="!block.text_only">
                   <p>
                     <span rt-if="!block.text_url">{block.description}</span>
                     <a rt-if="block.text_url" href="{block.text_url}">{block.description}</a>
                   </p>
                 </td>
                 <td colspan="0" rt-if="!block.text_only">
                   <p rt-if="block.select">
                     {block.prefix}
                     <select id="{block.select.id}"
                     data-action_key="{this.state.key}"
                     onChange="{this.handleChange.bind(this)}"
                     value="{this.getSelectedOption(block.select.id)}">
                      <option rt-repeat="option in this.setSelectOptions(block.select)"
                        value="{option.value}"
                        key="{optionIndex}">{option.text}</option>
                    </select>
                    {block.suffix}
                   </p>
                   <p rt-if="block.input">
                     <span>{block.prefix} </span>
                     <input type="text" id="{block.input.id}"
                     value="{this.setInputState(block.input.id)}"
                     size="{block.input.size}"
                     maxlength="{block.input.maxlength}"
                     onChange="{this.updateActionInput.bind(this)}">
                     <span> {block.suffix}</span>
                   </p>
                   <p rt-if="block.show" id="{block.show}">
                     <span>{block.prefix} </span>
                     {this.displayStateValue(block.show, block.suffix)}
                   </p>
                 </td>
               </tr>
               <tr rt-if="block.assumptions" className="action__assumptions-header">
                 <td colspan="2"><h4 className="text-center">{this.t('action.assumptions')}:</h4></td>
               </tr>
               <tr rt-if="block.assumptions" rt-repeat="a in block.assumptions"
                className="action__assumptions-body"
                key="{aIndex}">
                 <td colspan="2" rt-if="a.text_only">
                   <p className="text-center">
                     {a.description}
                   </p>
                 </td>
                 <td colspan="0" rt-if="!a.text_only">
                   <p className="text-right">
                     {a.description}
                   </p>
                 </td>
                 <td colspan="0" rt-if="!a.text_only">
                   <p rt-if="a.input">
                     <span>{a.prefix} </span>
                     <input type="text" id="{a.input.id}"
                     value="{this.setInputState(a.input.id)}"
                     size="{a.input.size}"
                     maxlength="{a.input.maxlength}"
                     onChange="{this.updateActionInput.bind(this)}">
                     <span> {a.suffix}</span>
                   </p>
                   <p rt-if="a.show" id="{a.show}">
                     <span>{a.prefix} </span>
                     {this.displayStateValue(a.show, a.suffix)}
                   </p>
                   <p rt-if="a.select">
                     {a.prefix}
                     <select id="{a.select.id}"
                     data-action_key="{this.state.key}"
                     onChange="{this.handleChange.bind(this)}"
                     value="{this.getSelectedOption(a.select.id)}">
                      <option rt-repeat="option in this.setSelectOptions(a.select)"
                        value="{option.value}"
                        key="{optionIndex}">{option.text}</option>
                    </select>
                    {a.suffix}
                   </p>
                 </td>
               </tr>
             </virtual>
           </tbody>
         </table>
         <table className="table">
           <tbody>
             <tr rt-if="this.fact">
               <td colspan="2">
                 <p className="action__fact">
                   {this.fact}
                 </p>
               </td>
             </tr>
             <tr rt-if="this.rebates">
               <td colspan="2">
                 <a href="{this.rebates.url}" target="_blank">{this.rebates.text}</a>
               </td>
             </tr>
           </tbody>
         </table>
      </div>
    </div>
    <div class="mark-not-relevant">
      <button type="button" class="btn btn-link btn-xs"
        onClick="{this.discardAction.bind(this)}">
        <span rt-if="!this.not_relevant">{this.t('action.mark_not_relevant')}</span>
        <span class="not-relevant" rt-if="this.not_relevant">{this.t('action.marked_not_relevant')}</span>
      </button>
    </div>
  </div>

  <div className="critical_assumptions" rt-if="this.props.is_assumption">
     <table className="table">
       <tbody>
         <tr rt-repeat="block in this.assumptions_content" key="{blockIndex}">
           <td>
             <p className="text-right">
               <span rt-if="!block.text_url">{block.description}</span>
               <a rt-if="block.text_url" href="{block.text_url}">{block.description}</a>
             </p>
           </td>
           <td>
             <p rt-if="block.input" className="text-left">
               <span>{block.prefix} </span>
               <input type="text" id="{block.input.id}"
               value="{this.setInputState(block.input.id)}"
               size="{block.input.size}"
               maxlength="{block.input.maxlength}"
               onChange="{this.updateActionInput.bind(this)}">
               <span> {block.suffix}</span>
             </p>
             <p rt-if="block.show" id="{block.show}" className="text-left">
               <span>{block.prefix} </span>
               {this.displayStateValue(block.show, block.suffix)}
             </p>
           </td>
         </tr>
       </tbody>
     </table>
  </div>
</div>
